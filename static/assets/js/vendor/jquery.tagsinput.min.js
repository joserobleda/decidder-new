(function(c){var a=new Array();var b=new Array();c.fn.doAutosize=function(h){var f=c(this).data("minwidth"),p=c(this).data("maxwidth"),k="",n=c(this),j=c("#"+c(this).data("tester_id"));
if(k===(k=n.val())){return;}var e=k.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");j.html(e);var m=j.width(),l=(m+h.comfortZone)>=f?m+h.comfortZone:f,g=n.width(),d=(l<g&&l>=f)||(l>f&&l<p);
if(d){n.width(l);}};c.fn.resetAutosize=function(f){var h=c(this).data("minwidth")||f.minInputWidth||c(this).width(),j=c(this).data("maxwidth")||f.maxInputWidth||(c(this).closest(".tagsinput").width()-f.inputPadding),k="",e=c(this),g=c("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:e.css("fontSize"),fontFamily:e.css("fontFamily"),fontWeight:e.css("fontWeight"),letterSpacing:e.css("letterSpacing"),whiteSpace:"nowrap"}),d=c(this).attr("id")+"_autosize_tester";
if(!c("#"+d).length>0){g.attr("id",d);g.appendTo("body");}e.data("minwidth",h);e.data("maxwidth",j);e.data("tester_id",d);e.css("width",h);};c.fn.addTag=function(e,d){d=jQuery.extend({focus:false,callback:true},d);
this.each(function(){var l=c(this).attr("id");var g=c(this).val().split(a[l]);c(this).trigger("keyup");if(g[0]==""){g=new Array();}e=jQuery.trim(e);if(d.unique){var h=c(this).tagExist(e);
if(h==true){c("#"+l+"_tag").addClass("not_valid");}}else{var h=false;}if(e!=""&&h!=true){c("<span>").addClass("tag").append(c("<span>").text(e).append("&nbsp;&nbsp;"),c("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return c("#"+l).removeTag(escape(e));
})).insertBefore("#"+l+"_addTag");g.push(e);c("#"+l+"_tag").val("");if(d.focus){c("#"+l+"_tag").focus();}else{c("#"+l+"_tag").blur();}c.fn.tagsInput.updateTagsField(this,g);
if(d.callback&&b[l]&&b[l]["onAddTag"]){var k=b[l]["onAddTag"];k.call(this,e);}if(b[l]&&b[l]["onChange"]){var j=g.length;var k=b[l]["onChange"];k.call(this,c(this),g[j-1]);
}}});return false;};c.fn.removeTag=function(d){d=unescape(d);this.each(function(){var h=c(this).attr("id");var e=c(this).val().split(a[h]);c(this).trigger("keyup");
c("#"+h+"_tagsinput .tag").remove();str="";for(i=0;i<e.length;i++){if(e[i]!=d){str=str+a[h]+e[i];}}c.fn.tagsInput.importTags(this,str);if(b[h]&&b[h]["onRemoveTag"]){var g=b[h]["onRemoveTag"];
g.call(this,d);}});return false;};c.fn.tagExist=function(e){var f=c(this).attr("id");var d=c(this).val().split(a[f]);return(jQuery.inArray(e,d)>=0);};c.fn.importTags=function(d){id=c(this).attr("id");
c("#"+id+"_tagsinput .tag").remove();c.fn.tagsInput.importTags(this,d);};c.fn.tagsInput=function(d){var e=jQuery.extend({interactive:true,defaultText:"add a tag",minChars:0,autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2,ready:function(){},},d);
this.each(function(){if(e.hide){c(this).hide();}var j=c(this).attr("id");if(!j||a[c(this).attr("id")]){j=c(this).attr("id","tags"+new Date().getTime()).attr("id");
}var h=jQuery.extend({pid:j,real_input:"#"+j,holder:"#"+j+"_tagsinput",input_wrapper:"#"+j+"_addTag",fake_input:"#"+j+"_tag"},e);a[j]=h.delimiter;if(e.onAddTag||e.onRemoveTag||e.onChange){b[j]=new Array();
b[j]["onAddTag"]=e.onAddTag;b[j]["onRemoveTag"]=e.onRemoveTag;b[j]["onChange"]=e.onChange;}var f='<div id="'+j+'_tagsinput" class="tagsinput"><div id="'+j+'_addTag">';
if(e.interactive){f=f+'<input id="'+j+'_tag" value="" data-default="'+e.defaultText+'" />';}f=f+'</div><div class="tags_clear"></div></div>';var g=c(f);
g.insertAfter(this);c(h.holder).css("width",e.width);c(h.holder).css("min-height",e.height);c(h.holder).css("height","100%");if(c(h.real_input).val()!=""){c.fn.tagsInput.importTags(c(h.real_input),c(h.real_input).val());
}if(e.interactive){c(h.fake_input).val(c(h.fake_input).attr("data-default"));c(h.fake_input).css("color",e.placeholderColor);c(h.holder).bind("click",h,function(k){c(k.data.fake_input).focus();
});c(h.fake_input).bind("focus",h,function(k){if(c(k.data.fake_input).val()==c(k.data.fake_input).attr("data-default")){c(k.data.fake_input).val("");}c(k.data.fake_input).css("color","#000000");
});if(e.autocomplete_url!=undefined){autocomplete_options={source:e.autocomplete_url};for(attrname in e.autocomplete){autocomplete_options[attrname]=e.autocomplete[attrname];
}if(jQuery.Autocompleter!==undefined){c(h.fake_input).autocomplete(e.autocomplete_url,e.autocomplete);c(h.fake_input).bind("result",h,function(k,m,l){if(m){c("#"+j).addTag(m[0]+"",{focus:true,unique:(e.unique)});
}});}else{if(jQuery.ui.autocomplete!==undefined){c(h.fake_input).autocomplete(autocomplete_options);c(h.fake_input).bind("autocompleteselect",h,function(k,l){c(k.data.real_input).addTag(l.item.value,{focus:true,unique:(e.unique)});
return false;});}}}else{c(h.fake_input).bind("blur",h,function(k){var l=c(this).attr("data-default");if(c(k.data.fake_input).val()!=""&&c(k.data.fake_input).val()!=l){if((k.data.minChars<=c(k.data.fake_input).val().length)&&(!k.data.maxChars||(k.data.maxChars>=c(k.data.fake_input).val().length))){c(k.data.real_input).addTag(c(k.data.fake_input).val(),{focus:true,unique:(e.unique)});
}}else{c(k.data.fake_input).val(c(k.data.fake_input).attr("data-default"));c(k.data.fake_input).css("color",e.placeholderColor);}return false;});}c(h.fake_input).bind("keypress",h,function(k){if(k.which==k.data.delimiter.charCodeAt(0)||k.which==13){k.preventDefault();
if((k.data.minChars<=c(k.data.fake_input).val().length)&&(!k.data.maxChars||(k.data.maxChars>=c(k.data.fake_input).val().length))){c(k.data.real_input).addTag(c(k.data.fake_input).val(),{focus:true,unique:(e.unique)});
}c(k.data.fake_input).resetAutosize(e);return false;}else{if(k.data.autosize){c(k.data.fake_input).doAutosize(e);}}});h.removeWithBackspace&&c(h.fake_input).bind("keydown",function(l){if(l.keyCode==8&&c(this).val()==""){l.preventDefault();
var k=c(this).closest(".tagsinput").find(".tag:last").text();var m=c(this).attr("id").replace(/_tag$/,"");k=k.replace(/[\s]+x$/,"");c("#"+m).removeTag(escape(k));
c(this).trigger("focus");}});c(h.fake_input).blur();if(h.unique){c(h.fake_input).keydown(function(k){if(k.keyCode==8||String.fromCharCode(k.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){c(this).removeClass("not_valid");
}});}}e.ready.call(g.get(0));});return this;};c.fn.tagsInput.updateTagsField=function(e,d){var f=c(e).attr("id");c(e).val(d.join(a[f]));};c.fn.tagsInput.importTags=function(g,h){c(g).val("");
var j=c(g).attr("id");var d=h.split(a[j]);for(i=0;i<d.length;i++){c(g).addTag(d[i],{focus:false,callback:false});}if(b[j]&&b[j]["onChange"]){var e=b[j]["onChange"];
e.call(g,g,d[i]);}};})(jQuery);