(function(b,e){var c=$("#canvas"),a=$("form#question");var d=function(g){g.preventDefault();var f=["#responses","#context","#doubts","#question h1"];$.get(document.location.pathname,function(k){var l=$(k);
for(var j in f){var h=f[j];$(h).replaceWith(l.find(h));}});};$.fn.bindCustomEvents=function(){var f=$(this);f.find(".confirm").click(function(i){var h=$(this),g=h.data("confirm")||"Are you sure?";
if(!confirm(g)){i.preventDefault();}});f.find("a.xhr-refresh").click(d);f.find(".hide-target").click(function(i){var h=$(this),g=h.data("target");$(g).hide();
});f.find("[title]").tipsy({gravity:$.fn.tipsy.autoNS});f.find(".async").click(function(){event.preventDefault();var g=$(this).attr("href"),h=$(this).attr("target");
$.get(g,function(j){var i=$(h).html(j);i.bindCustomEvents();i.show();});});f.find("form").each(function(){});f.find(".popup").click(function(m){var i=$(this).attr("href"),h=$(this).data("popup-name")||false,j=$(this).data("popup-width")||500,g=$(this).data("popup-height")||280,l=(screen.width/2)-(j/2),k=(screen.height/2)-(g/2);
window.open(i,h,"height="+g+",width="+j+",top="+k+",left="+l+",resizable=no");});f.find(".tw-count").each(function(){var i=$(this),g=i.data("fb-url")||location.href,h="http://urls.api.twitter.com/1/urls/count.json?url="+encodeURI(g)+"&amp;callback=?";
function j(k){i.html(k);}$.getJSON(h,function(k){if(k){j(k.count);}});});f.find(".fb-count").each(function(){var k=$(this),j,i=(k.data("fb-count")||"share")+"_count",g=k.data("fb-url")||location.href,h="https://api.facebook.com/method/fql.query?query=select "+i+" from link_stat where url='"+encodeURI(g)+"'&format=json";
function l(m){k.html(m);}$.getJSON(h,function(m){if(m[0]&&m[0][i]!==e){l(m[0][i]);}});});f.find(".reveal").click(function(){var n=$(this),j=n.data("reveal-target")||null,o=n.data("reveal-src")||null;
if(f.hasClass("modal")){f.remove();}function r(){c.css({height:"100%",overflow:"hidden"});}function k(){c.css({height:"inherit",overflow:"auto"});}function m(u){var t=$(u),v=n.data();
v.open=function(){t.find("input[type=text],textarea,select").not(":disabled").filter(":first").focus();};v.close=function(){k();if(typeof u=="object"){t.remove();
}};t.css("margin-left","-"+(t.outerWidth()/2)+"px");t.css("margin-top","-"+(t.outerHeight()/2)+"px");t.reveal(v);}r();if(j){return m(j);}if(o){var q=$("#loading"),l=false,s,i=o,h="get",p=i.indexOf(":"),g=(p>-1&&p<5);
if(g){h=i.substring(0,p);i=i.substring(p+1);}q.reveal({close:function(){k();if(s&&s.abort()){s.abort();}},opened:function(){if(l){q.trigger("reveal:close");
}}});s=$.ajax({url:i,type:h,error:function(v,t,u){alert(u);l=u;},success:function(v,u,w){var x=w.getResponseHeader("content-type");if(x.indexOf("text/html")===0){var t=$(v).hide().appendTo(c);
q.hide();t.bindCustomEvents();m(t);}}});}});};if(a.length){require(["widget/formEditable"],function(){a.editable(function(f){$(f).bind("edit",function(){$("input.taglist").tagsInput({defaultText:"add predefined response",placeholderColor:"#bbb",ready:function(){$(this).attr("data-form-editing",true);
}});a.find("input.taglist").hide();});$(f).bind("show",function(){console.log("$$$#@");a.find(".tagsinput").remove();a.find("ul.predefinded").addClass("prueba");
});$(f).bind("error",function(){alert("Error, try again!");});if($.address.value()==="/edit"){$(f).bind("show",function(){location.href="#";});f.edit();
}});});require(["/socket.io/socket.io.js"],function(){var i=a.data("is-owner"),j=$("#viewers"),k=$("#updates"),g=1,f=document.location.pathname.split("/")[2],h=io.connect(document.location.protocol+"//"+document.location.host+"/question");
h.on("connect",function(){h.emit("join",f);});h.on("change",function(l){if(i==true&&l.type=="question"){return;}k.slideDown();});h.on("viewers",function(l){if(g!=l){g=l;
j.html(l);}});});}$(document).bindCustomEvents();})(window);