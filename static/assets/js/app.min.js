(function(b,d){var c=$("#canvas"),a=$("form#question");$.fn.bindCustomEvents=function(){var e=$(this);e.find(".async").click(function(){event.preventDefault();
var f=$(this).attr("href"),g=$(this).attr("target");$.get(f,function(i){var h=$(g).html(i);h.bindCustomEvents();h.show();});});e.find("form").each(function(){});
e.find(".popup").click(function(l){var h=$(this).attr("href"),g=$(this).data("popup-name")||false,i=$(this).data("popup-width")||500,f=$(this).data("popup-height")||280,k=(screen.width/2)-(i/2),j=(screen.height/2)-(f/2);
window.open(h,g,"height="+f+",width="+i+",top="+j+",left="+k+",resizable=no");});e.find(".tw-count").each(function(){var h=$(this),f=h.data("fb-url")||location.href,g="http://urls.api.twitter.com/1/urls/count.json?url="+encodeURI(f)+"&amp;callback=?";
function i(j){h.html(j);}$.getJSON(g,function(j){if(j){i(j.count);}});});e.find(".fb-count").each(function(){var j=$(this),i,h=(j.data("fb-count")||"share")+"_count",f=j.data("fb-url")||location.href,g="https://api.facebook.com/method/fql.query?query=select "+h+" from link_stat where url='"+encodeURI(f)+"'&format=json";
function k(l){j.html(l);}$.getJSON(g,function(l){if(l[0]&&l[0][h]!==d){k(l[0][h]);}});});e.find(".reveal").click(function(){var m=$(this),i=m.data("reveal-target")||null,n=m.data("reveal-src")||null;
if(e.hasClass("modal")){e.remove();}function q(){c.css({height:"100%",overflow:"hidden"});}function j(){c.css({height:"inherit",overflow:"auto"});}function l(t){var s=$(t),u=m.data();
u.open=function(){s.find("input[type=text],textarea,select").not(":disabled").filter(":first").focus();};u.close=function(){j();if(typeof t=="object"){s.remove();
}};s.css("margin-left","-"+(s.outerWidth()/2)+"px");s.css("margin-top","-"+(s.outerHeight()/2)+"px");s.reveal(u);}q();if(i){return l(i);}if(n){var p=$("#loading"),k=false,r,h=n,g="get",o=h.indexOf(":"),f=(o>-1&&o<5);
if(f){g=h.substring(0,o);h=h.substring(o+1);}p.reveal({close:function(){j();if(r&&r.abort()){r.abort();}},opened:function(){if(k){p.trigger("reveal:close");
}}});r=$.ajax({url:h,type:g,error:function(u,s,t){alert(t);k=t;},success:function(u,t,v){var w=v.getResponseHeader("content-type");if(w.indexOf("text/html")===0){var s=$(u).hide().appendTo(c);
p.hide();s.bindCustomEvents();l(s);}}});}});};if(a.length){require(["widget/formEditable"],function(){a.editable(function(e){$(e).bind("edit",function(){$("input.taglist").tagsInput({defaultText:"add predefined response",placeholderColor:"#bbb",ready:function(){$(this).attr("data-form-editing",true);
}});});$(e).bind("show",function(){a.find(".tagsinput").remove();});$(e).bind("error",function(){alert("Error, try again!");});if($.address.value()==="/edit"){$(e).bind("show",function(){location.href="#";
});e.edit();}});});require(["/socket.io/socket.io.js"],function(){var e=document.location.pathname.split("/")[2];var f=io.connect(document.location.protocol+"//"+document.location.host+"/question");
f.on("connect",function(){f.emit("join",e);});f.on("change",function(g){$.get(document.location.pathname,function(i){var h=$(i).find("#responses").html();
$("#responses").html(h);});});});}$(document).bindCustomEvents();})(window);