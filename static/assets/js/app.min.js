(function(b,d){var c=$("#canvas"),a=$("form#question");$.fn.bindCustomEvents=function(){$(this).find(".async").click(function(){event.preventDefault();
var e=$(this).attr("href"),f=$(this).attr("target");$.get(e,function(h){var g=$(f).html(h);g.bindCustomEvents();g.show();});});$(this).find("form").each(function(){});
$(this).find(".popup").click(function(l){var h=$(this).attr("href"),g=$(this).data("popup-name")||false,i=$(this).data("popup-width")||500,f=$(this).data("popup-height")||280,k=(screen.width/2)-(i/2),j=(screen.height/2)-(f/2);
window.open(h,g,"height="+f+",width="+i+",top="+j+",left="+k+",resizable=no");});$(this).find(".tw-count").each(function(){var g=$(this),e=g.data("fb-url")||location.href,f="http://urls.api.twitter.com/1/urls/count.json?url="+encodeURI(e)+"&amp;callback=?";
function h(i){g.html(i);}$.getJSON(f,function(i){if(i){h(i.count);}});});$(this).find(".fb-count").each(function(){var i=$(this),h,g=(i.data("fb-count")||"share")+"_count",e=i.data("fb-url")||location.href,f="https://api.facebook.com/method/fql.query?query=select "+g+" from link_stat where url='"+encodeURI(e)+"'&format=json";
function j(k){i.html(k);}$.getJSON(f,function(k){if(k[0]&&k[0][g]!==d){j(k[0][g]);}});});$(this).find(".reveal").click(function(){var l=$(this),h=l.data("reveal-target")||null,m=l.data("reveal-src")||null;
function p(){c.css({height:"100%",overflow:"hidden"});}function i(){c.css({height:"inherit",overflow:"auto"});}function k(s){var r=$(s),t=l.data();t.open=function(){r.find("input[type=text],textarea,select").not(":disabled").filter(":first").focus();
};t.close=function(){i();if(typeof s=="object"){r.remove();}};r.css("margin-left","-"+(r.outerWidth()/2)+"px");r.css("margin-top","-"+(r.outerHeight()/2)+"px");
r.reveal(t);}p();if(h){return k(h);}if(m){var o=$("#loading"),j=false,q,g=m,f="get",n=g.indexOf(":"),e=(n>-1&&n<5);if(e){f=g.substring(0,n);g=g.substring(n+1);
}o.reveal({close:function(){i();if(q&&q.abort()){q.abort();}},opened:function(){if(j){o.trigger("reveal:close");}}});q=$.ajax({url:g,type:f,error:function(t,r,s){alert(s);
j=s;},success:function(t,s,u){var v=u.getResponseHeader("content-type");if(v.indexOf("text/html")===0){var r=$(t).hide().appendTo(c);o.hide();r.bindCustomEvents();
k(r);}}});}});};if(a.length){require(["widget/formEditable"],function(){a.editable(function(e){$(e).bind("edit",function(){$("input.taglist").tagsInput({defaultText:"add predefined response",placeholderColor:"#bbb",ready:function(){$(this).attr("data-form-editing",true);
}});});$(e).bind("show",function(){a.find(".tagsinput").remove();});$(e).bind("error",function(){alert("Error, try again!");});if($.address.value()==="/edit"){$(e).bind("show",function(){location.href="#";
});e.edit();}});});require(["/socket.io/socket.io.js"],function(){var e=document.location.pathname.split("/")[2];var f=io.connect(document.location.protocol+"//"+document.location.host+"/question");
f.on("connect",function(){f.emit("join",e);});f.on("change",function(g){$.get(document.location.pathname,function(i){var h=$(i).find("#responses").html();
$("#responses").html(h);});});});}$(document).bindCustomEvents();})(window);